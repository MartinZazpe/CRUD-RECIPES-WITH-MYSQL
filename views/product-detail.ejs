<!DOCTYPE html>
<html>

<head>
    <title></title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <link rel='stylesheet' href='/stylesheets/product-detail.css' />
    <title>Home</title>
    <!-- <script src="/javascripts/product-detail.js"></script> -->
</head>

<body>
    <%- include("partials/header.ejs") %>
        <main>
            <div class="body-information">
                <section class="introduction">
                    <% if(locals.recipe) { %>
                        <h3>
                            <%=recipe.title %>
                        </h3>
                </section>
                <div class="description-hyperlink">
                    <p>
                        <%=recipe.description %>
                    </p>
                </div>
                <section class="recipe-examples">
                    <div class="container-product">
                        <div class="OneProductContainer">
                            <div class="image-avg-container">
                                <div class="AVGrating">

                                    <div>
                                        <% if(locals.ratingAvg> 0) {Â %>
                                            <h5>
                                                <%= ratingAvg %> / 5 <i class="colorGold fa-lg fa-solid fa-star"></i>
                                            </h5>
                                            <% }%>
                                    </div>
                                </div>
                                <div class="image-container">
                                    <img class="OneRecipeImage" src="/images/<%= recipe.image %>">
                                </div>
                            </div>


                            <div class="ingredients">
                                <ul class="ingredients-list">
                                    <p class="ingredients-title">Ingredients:</p>
                                    <% for(let i=0; i < recipe.Ingredients.length; i++ ){ %>
                                        <li>
                                            <%= recipe.Ingredients[i] %>
                                        </li>
                                        <% } %>
                                </ul>
                            </div>

                            <div class="directions">

                            </div>

                            <% if(locals.userLogged){ %>
                                <% if(userLogged.email==recipe.belongsTo) { %>
                                    <% if(locals.userLoggedEmail){ %>
                                        <% if(userLoggedEmail==recipe.belongsTo) {%>
                                            <a class="edit-icon" href="/recipes/edit/<%=recipe.id%>">Edit my recipe<i class="fa-solid fa-pen"></i></a>
                                            <% } %>
                                                <% } %>
                                                    <% } %>
                                                        <% } %>
                        </div>
                    </div>
                </section>
                <% } %>


                    <div class="comment-section-container">
                        <div class="comment-section">
                            <div class="comments-header">
                                <h4>Reviews ( <%=amountOfReviews %> )</h4>
                                <span></span>
                                <span></span>
                            </div>
                            <% if(locals.comments) { %>
                                <% for(let comment of comments) {%>
                                    <% for(let user of allUsers){ %>
                                        <% if(user.email==comment.belongsTo){ %>
                                            <div class="user-comment-container">
                                                <img class="user-comment-image" src="/images/userImages/<%= user.image %>" alt="user-image">
                                                <% } %>
                                                    <% } %>
                                                        <p class="comment-belongsTo">
                                                            <%=comment.belongsTo %>
                                                        </p>
                                                        <p class="comment-userComment">
                                                            <%=comment.userComment%>
                                                        </p>
                                            </div>
                                            <% } %>
                                                <% } %>
                        </div>

                        <div class="comment-form-container">


                            <form class="comment-form" action="/recipes/comments/<%=recipe.id%>" method="POST">

                                <div class="container">
                                    <p>Rate this recipe:</p>

                                    <div class="star-widget">
                                        <input type="radio" name="rate" value="5" id="rate-5">
                                        <label for="rate-5"><i class="fa-solid fa-star"></i>
                                        </label>

                                        <input type="radio" name="rate" value="4" id="rate-4">
                                        <label for="rate-4"><i class="fa-solid fa-star"></i>
                                        </label>

                                        <input type="radio" name="rate" value="3" id="rate-3">
                                        <label for="rate-3"><i class="fa-solid fa-star"></i>
                                        </label>

                                        <input type="radio" name="rate" value="2" id="rate-2">
                                        <label for="rate-2"><i class="fa-solid fa-star"></i>
                                        </label>

                                        <input type="radio" name="rate" value="1" id="rate-1">
                                        <label for="rate-1"><i class="fa-solid fa-star"></i>
                                        </label>

                                    </div>
                                </div>

                                <textarea name="comments" id="" cols="30" rows="10" placeholder="Hey <%if(locals.userLogged){ %> <%=userLogged.name %><% } %>, what do you think about this recipe?"></textarea>
                                <!-- <input type="text" name="comments" placeholder="What do you think about this recipe?"> -->
                                <div class="error-container">
                                    <% if(locals.errors) { %>
                                        <p class="text-danger">
                                            <%= errors.mustWaitToComment.msg %>
                                        </p>
                                        <% } %>
                                </div>
                                <button type="submit">Submit</button>

                            </form>
                        </div>
                    </div>

                    <!-- </section>
            </div> -->
        </main>
        <%- include("partials/footer.ejs") %>
</body>

</html>